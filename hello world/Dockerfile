#	Instructions to build and run this Dockerfile
#
#	You must build with the command
#	$ sudo docker build --tag hello .
#
#	Then run 
#	$ sudo docker run --rm hello
#
#


#########################################################################################################################################################
#########################################################################################################################################################
#	1 - Install dependencies for Qt
#########################################################################################################################################################
#########################################################################################################################################################
FROM ubuntu:bionic as dependencies

# Install build dependencies
RUN apt-get update
RUN apt-get -y --no-install-recommends install \
	build-essential \
	libboost-all-dev \
	python2.7 \
	libusb-1.0-0 \
	cmake \
	pkg-config

#RUN apt-get clean


#########################################################################################################################################################
#########################################################################################################################################################
#	2 - QtBuild
#########################################################################################################################################################
#########################################################################################################################################################
FROM dependencies as QtBuild

RUN apt-get -y --no-install-recommends install \
	qt5-default


#########################################################################################################################################################
#########################################################################################################################################################
#	VTS_Build
#########################################################################################################################################################
#########################################################################################################################################################
FROM QtBuild as VTS

# Copy the current folder which contains C++ source code to the Docker image under /usr/src
COPY . /usr/src/buildVTS

# Specify the working directory
WORKDIR /usr/src/buildVTS


# Let CMake build the software
RUN cmake . && cmake --build .


# Run the program output from the previous step
CMD ["./helloTest"]
